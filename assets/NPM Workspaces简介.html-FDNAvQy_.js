import{_ as t,r as p,o,c as l,a as s,b as n,d as e,e as c}from"./app-ATJF5j0V.js";const r={},i=c(`<blockquote><p>npm在2020年10月发布的版本开始支持一个新功能：Workspaces</p></blockquote><h3 id="workspaces是什么" tabindex="-1"><a class="header-anchor" href="#workspaces是什么"><span>Workspaces是什么？</span></a></h3><p><code>Workspaces</code>即工作区，可以帮我们管理包含多个<code>包（package）</code>的项目，这些项目（称为monorepo）可能包含多个<code>package.json</code>，而Workspaces可以方便的对这类项目进行管理。</p><h3 id="举例说明" tabindex="-1"><a class="header-anchor" href="#举例说明"><span>举例说明</span></a></h3><p>一个简单的多包依赖项目的例子如下：</p><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code>├── index<span class="token punctuation">.</span>js
├── <span class="token keyword">package</span><span class="token punctuation">.</span>json
└── packages
    ├── packageA
    │   ├── index<span class="token punctuation">.</span>js
    │   └── <span class="token keyword">package</span><span class="token punctuation">.</span>json # Dependencies<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token string">vuepress</span><span class="token template-punctuation string">\`</span></span><span class="token punctuation">,</span><span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token string">packageB</span><span class="token template-punctuation string">\`</span></span>
    └── packageB
        ├── index<span class="token punctuation">.</span>js
        └── <span class="token keyword">package</span><span class="token punctuation">.</span>json # Dependencies<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token string">vuepress</span><span class="token template-punctuation string">\`</span></span><span class="token punctuation">,</span> <span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token string">packageA</span><span class="token template-punctuation string">\`</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>当我们在根目录运行<code>npm install</code> 或 <code>yarn install</code>的时候，npm会在根文件的<code>node_modules</code>下创建彼此的符号链接，以便package能够引入，如下：</p><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code>├── node_modules # 根文件 node_modules
│   ├── vuepress # 依赖的vuepress
│   ├── packageA # 符号链接包<span class="token constant">A</span>
│   └── packageB # 符号链接包<span class="token constant">B</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="配置和使用" tabindex="-1"><a class="header-anchor" href="#配置和使用"><span>配置和使用</span></a></h3><p>在根项目目录下的<code>packages.json</code>中配置<code>workspaces</code>关键字：</p><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token string-property property">&quot;workspaces&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token string">&quot;packages/*&quot;</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>子包中的<code>package.json</code>添加<code>dependencies</code>对其它包的依赖 然后运行npm，则可以在子包中非常方便的使用本地依赖库了。</p><h3 id="其它用法" tabindex="-1"><a class="header-anchor" href="#其它用法"><span>其它用法</span></a></h3><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code># Run <span class="token string">&quot;test&quot;</span> script on all packages
npm run test <span class="token operator">--</span>workspaces
npm run test  <span class="token operator">-</span>ws

# Runs <span class="token string">&quot;test&quot;</span> only on packageA
npm run test <span class="token operator">--</span>workspace packageA
npm run test <span class="token operator">-</span>w packageB

# Install <span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token string">lodash</span><span class="token template-punctuation string">\`</span></span> on <span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token string">packageA</span><span class="token template-punctuation string">\`</span></span>
npm install lodash <span class="token operator">--</span>workspace packageA

# Install <span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token string">tap</span><span class="token template-punctuation string">\`</span></span> on <span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token string">packageB</span><span class="token template-punctuation string">\`</span></span> <span class="token keyword">as</span> a dev dependency
npm install tap <span class="token operator">--</span>workspace packageB <span class="token operator">--</span>save<span class="token operator">-</span>dev

# Install <span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token string">packageA</span><span class="token template-punctuation string">\`</span></span> on <span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token string">packageB</span><span class="token template-punctuation string">\`</span></span>
npm install packageA <span class="token operator">--</span>workspace packageB

# Install <span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token string">eslint</span><span class="token template-punctuation string">\`</span></span> <span class="token keyword">in</span> all packages
npm install eslint <span class="token operator">--</span>workspaces
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="npm-工作区-与-yarn-工作区" tabindex="-1"><a class="header-anchor" href="#npm-工作区-与-yarn-工作区"><span>npm 工作区 与 Yarn 工作区</span></a></h3><p>Yarn中也有命令来管理workspaces, 例如：</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token function">yarn</span> workspace <span class="token operator">&lt;</span>workspace<span class="token operator">&gt;</span> <span class="token function">add</span> <span class="token operator">&lt;</span>dependency<span class="token operator">&gt;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="使用-lerna" tabindex="-1"><a class="header-anchor" href="#使用-lerna"><span>使用 Lerna</span></a></h3>`,18),d={href:"https://github.com/lerna/lerna",target:"_blank",rel:"noopener noreferrer"},u={href:"https://github.com/vuepress/vuepress-next",target:"_blank",rel:"noopener noreferrer"},k=s("h3",{id:"参考",tabindex:"-1"},[s("a",{class:"header-anchor",href:"#参考"},[s("span",null,"参考")])],-1),m={href:"https://docs.npmjs.com/cli/v7/using-npm/workspaces",target:"_blank",rel:"noopener noreferrer"},g={href:"https://ruanmartinelli.com/posts/npm-7-workspaces-1",target:"_blank",rel:"noopener noreferrer"},v={href:"https://github.com/vuepress/vuepress-next",target:"_blank",rel:"noopener noreferrer"};function h(b,_){const a=p("ExternalLinkIcon");return o(),l("div",null,[i,s("p",null,[n("使用 npm workspaces 和 yarn workspaces 虽然可以管理一些monorepos 但对于一些更大的项目来说，它包含更多的依赖树，这时可能就要使用类似"),s("a",d,[n("Lerna"),e(a)]),n("这样的管理工具了。 Lerna 有很多命令来管理大型的monorepo。 在"),s("a",u,[n("VuePress"),e(a)]),n("项目中结合使用了这两个功能，读者可以参考其用法。")]),k,s("blockquote",null,[s("p",null,[s("a",m,[n("NPM Workspaces"),e(a)]),s("a",g,[n("Getting Started with npm Workspaces"),e(a)]),s("a",v,[n("Vuepress repository"),e(a)])])])])}const f=t(r,[["render",h],["__file","NPM Workspaces简介.html.vue"]]),j=JSON.parse('{"path":"/posts/frontend/NPM%20Workspaces%E7%AE%80%E4%BB%8B.html","title":"NPM Workspaces简介","lang":"zh-CN","frontmatter":{"title":"NPM Workspaces简介","toc":true,"keywords":"workspaces,npm,npm包,packages.json,包依赖","tags":["npm","workspaces"],"categories":["前端基础"],"abbrlink":"923ed035","date":"2021-09-01T19:13:16.000Z"},"headers":[{"level":3,"title":"Workspaces是什么？","slug":"workspaces是什么","link":"#workspaces是什么","children":[]},{"level":3,"title":"举例说明","slug":"举例说明","link":"#举例说明","children":[]},{"level":3,"title":"配置和使用","slug":"配置和使用","link":"#配置和使用","children":[]},{"level":3,"title":"其它用法","slug":"其它用法","link":"#其它用法","children":[]},{"level":3,"title":"npm 工作区 与 Yarn 工作区","slug":"npm-工作区-与-yarn-工作区","link":"#npm-工作区-与-yarn-工作区","children":[]},{"level":3,"title":"使用 Lerna","slug":"使用-lerna","link":"#使用-lerna","children":[]},{"level":3,"title":"参考","slug":"参考","link":"#参考","children":[]}],"git":{"updatedTime":1712251162000,"contributors":[{"name":"yushen","email":"85443289+yushenw@users.noreply.github.com","commits":1}]},"filePathRelative":"posts/frontend/NPM Workspaces简介.md","excerpt":"<blockquote>\\n<p>npm在2020年10月发布的版本开始支持一个新功能：Workspaces</p>\\n</blockquote>\\n<h3>Workspaces是什么？</h3>\\n<p><code>Workspaces</code>即工作区，可以帮我们管理包含多个<code>包（package）</code>的项目，这些项目（称为monorepo）可能包含多个<code>package.json</code>，而Workspaces可以方便的对这类项目进行管理。</p>\\n"}');export{f as comp,j as data};
