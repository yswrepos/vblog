import{_ as e,o as a,c as n,e as t}from"./app-CinGCuEv.js";const s={},i=t(`<p>网络接口通常通过配置文件（如 <code>/etc/config/network</code>）进行定义和管理。当您创建一个新的网络（例如，一个专门为访客设计的无线网络）时，您会指定一个接口名称。这个名称随后用于系统的其他配置部分，包括防火墙规则、DHCP配置等。</p><h3 id="如何创建访客网络接口" tabindex="-1"><a class="header-anchor" href="#如何创建访客网络接口"><span>如何创建访客网络接口</span></a></h3><ol><li><p><strong>在OpenWrt中添加网络接口</strong>：您可以通过Web界面（LuCI）或直接编辑配置文件来添加新的网络接口。例如，为访客网络添加一个新的无线网络SSID，并将其关联到一个新的网络接口（例如，<code>br-guest</code>）。</p></li><li><p><strong>配置文件示例</strong>：</p><ul><li><p>编辑 <code>/etc/config/network</code> 文件，添加如下配置以创建新的桥接接口（如果适用）：</p><div class="language-text line-numbers-mode" data-ext="text" data-title="text"><pre class="language-text"><code>config interface &#39;guest&#39;
    option type &#39;bridge&#39;
    option ifname &#39;eth0.3&#39;
    option proto &#39;static&#39;
    option ipaddr &#39;192.168.3.1&#39;
    option netmask &#39;255.255.255.0&#39;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>这里，<code>interface &#39;guest&#39;</code> 定义了一个新的网络接口名为 <code>guest</code>，您可以将其理解为 <code>br-guest</code>（如果您希望使用这个特定的名称，只需相应地修改配置即可）。</p></li></ul></li><li><p><strong>更新防火墙配置</strong>：之后，您需要根据新创建的接口名（如 <code>guest</code> 或您选择的任何名称）更新防火墙配置，确保访客网络的隔离。</p></li></ol><h3 id="注意事项" tabindex="-1"><a class="header-anchor" href="#注意事项"><span>注意事项</span></a></h3><ul><li>接口名称（如 <code>br-guest</code>）通常用于区分不同的网络（如主网络、访客网络、管理网络等）。</li><li>在配置网络和防火墙规则时，确保使用正确的接口名称，以保障规则的正确应用。</li><li>如果您通过Web界面（LuCI）操作，创建和配置网络接口的过程会更直观，系统会自动生成配置文件的相关条目。</li></ul><h2 id="防火墙规则" tabindex="-1"><a class="header-anchor" href="#防火墙规则"><span>防火墙规则</span></a></h2><p>要使用防火墙规则在同一网段内创建一个访客网络，您需要在网络层面上确保所有设备都可以获取IP地址（比如通过同一个DHCP服务器），同时在防火墙层面上隔离访客设备与主网络的通信。这种配置通常在企业或高级家庭网络中使用，允许访客接入网络而不访问内网资源。以下是一个基于OpenWrt（或类似系统）的示例步骤：</p><h3 id="_1-创建访客网络接口-可选" tabindex="-1"><a class="header-anchor" href="#_1-创建访客网络接口-可选"><span>1. 创建访客网络接口（可选）</span></a></h3><p>如果您的设备允许，在同一个物理接口上创建一个虚拟接口（例如，一个新的SSID用于无线访客网络）。这一步骤不是必须的，因为您的目标是在相同的网段上实现隔离，但它有助于组织和管理目的。</p><h3 id="_2-配置dhcp服务" tabindex="-1"><a class="header-anchor" href="#_2-配置dhcp服务"><span>2. 配置DHCP服务</span></a></h3><p>确保访客设备能够从同一个DHCP服务器获取IP地址。您可能需要配置DHCP服务器，以便为所有设备（包括访客设备）分配同一网段的IP地址。</p><h3 id="_3-配置防火墙规则" tabindex="-1"><a class="header-anchor" href="#_3-配置防火墙规则"><span>3. 配置防火墙规则</span></a></h3><p>关键步骤在于配置防火墙规则，以隔离访客设备。您需要创建规则，以阻止访客网络中的设备访问主网络中的资源，但允许它们访问外部互联网。使用OpenWrt，您可以通过编辑<code>/etc/config/firewall</code>文件或使用Web界面（如果可用）来完成此操作。</p><h4 id="示例防火墙规则" tabindex="-1"><a class="header-anchor" href="#示例防火墙规则"><span>示例防火墙规则</span></a></h4><p>以下是一个简单的例子，说明如何阻止访客网络访问内网资源：</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token comment"># 允许访客网络访问外部互联网</span>
iptables <span class="token parameter variable">-I</span> FORWARD <span class="token parameter variable">-i</span> br-guest <span class="token parameter variable">-o</span> eth0 <span class="token parameter variable">-j</span> ACCEPT

<span class="token comment"># 阻止访客网络访问内网（192.168.1.0/24为内网IP范围）</span>
iptables <span class="token parameter variable">-I</span> FORWARD <span class="token parameter variable">-i</span> br-guest <span class="token parameter variable">-d</span> <span class="token number">192.168</span>.1.0/24 <span class="token parameter variable">-j</span> REJECT

<span class="token comment"># 允许访客网络访问DHCP和DNS（如果需要）</span>
iptables <span class="token parameter variable">-I</span> INPUT <span class="token parameter variable">-i</span> br-guest <span class="token parameter variable">-p</span> udp <span class="token parameter variable">--dport</span> <span class="token number">67</span> <span class="token parameter variable">-j</span> ACCEPT
iptables <span class="token parameter variable">-I</span> INPUT <span class="token parameter variable">-i</span> br-guest <span class="token parameter variable">-p</span> udp <span class="token parameter variable">--dport</span> <span class="token number">53</span> <span class="token parameter variable">-j</span> ACCEPT
iptables <span class="token parameter variable">-I</span> INPUT <span class="token parameter variable">-i</span> br-guest <span class="token parameter variable">-p</span> tcp <span class="token parameter variable">--dport</span> <span class="token number">53</span> <span class="token parameter variable">-j</span> ACCEPT
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>在这个例子中，<code>br-guest</code>是访客网络接口的名称，<code>eth0</code>是连接到互联网的外部接口。您需要根据实际情况调整接口名称和IP地址范围。</p><h3 id="_4-应用并测试防火墙规则" tabindex="-1"><a class="header-anchor" href="#_4-应用并测试防火墙规则"><span>4. 应用并测试防火墙规则</span></a></h3><p>应用您的防火墙配置后，重启防火墙服务，然后测试配置以确保访客设备不能访问主网络，但可以正常上网。</p><p>这种配置的关键在于正确设置防火墙规则，以实现网络隔离的同时保持网络通信的需要。务必在实际部署前彻底测试配置，以确保网络安全性和功能性符合预期。</p>`,20),r=[i];function p(l,o){return a(),n("div",null,r)}const d=e(s,[["render",p],["__file","创建网络接口并使用防火墙隔离.html.vue"]]),m=JSON.parse(`{"path":"/posts/net/%E5%88%9B%E5%BB%BA%E7%BD%91%E7%BB%9C%E6%8E%A5%E5%8F%A3%E5%B9%B6%E4%BD%BF%E7%94%A8%E9%98%B2%E7%81%AB%E5%A2%99%E9%9A%94%E7%A6%BB.html","title":"post","lang":"zh-CN","frontmatter":{"title":"post","date":"2024-02-27T23:42:42.000Z","tags":null,"description":"网络接口通常通过配置文件（如 /etc/config/network）进行定义和管理。当您创建一个新的网络（例如，一个专门为访客设计的无线网络）时，您会指定一个接口名称。这个名称随后用于系统的其他配置部分，包括防火墙规则、DHCP配置等。 如何创建访客网络接口 在OpenWrt中添加网络接口：您可以通过Web界面（LuCI）或直接编辑配置文件来添加新的...","head":[["meta",{"property":"og:url","content":"https://b.yongzhenxin.com/posts/net/%E5%88%9B%E5%BB%BA%E7%BD%91%E7%BB%9C%E6%8E%A5%E5%8F%A3%E5%B9%B6%E4%BD%BF%E7%94%A8%E9%98%B2%E7%81%AB%E5%A2%99%E9%9A%94%E7%A6%BB.html"}],["meta",{"property":"og:site_name","content":"Yunshenw"}],["meta",{"property":"og:title","content":"post"}],["meta",{"property":"og:description","content":"网络接口通常通过配置文件（如 /etc/config/network）进行定义和管理。当您创建一个新的网络（例如，一个专门为访客设计的无线网络）时，您会指定一个接口名称。这个名称随后用于系统的其他配置部分，包括防火墙规则、DHCP配置等。 如何创建访客网络接口 在OpenWrt中添加网络接口：您可以通过Web界面（LuCI）或直接编辑配置文件来添加新的..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2024-04-04T17:19:22.000Z"}],["meta",{"property":"article:published_time","content":"2024-02-27T23:42:42.000Z"}],["meta",{"property":"article:modified_time","content":"2024-04-04T17:19:22.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"post\\",\\"image\\":[\\"\\"],\\"datePublished\\":\\"2024-02-27T23:42:42.000Z\\",\\"dateModified\\":\\"2024-04-04T17:19:22.000Z\\",\\"author\\":[]}"]]},"headers":[{"level":3,"title":"如何创建访客网络接口","slug":"如何创建访客网络接口","link":"#如何创建访客网络接口","children":[]},{"level":3,"title":"注意事项","slug":"注意事项","link":"#注意事项","children":[]},{"level":2,"title":"防火墙规则","slug":"防火墙规则","link":"#防火墙规则","children":[{"level":3,"title":"1. 创建访客网络接口（可选）","slug":"_1-创建访客网络接口-可选","link":"#_1-创建访客网络接口-可选","children":[]},{"level":3,"title":"2. 配置DHCP服务","slug":"_2-配置dhcp服务","link":"#_2-配置dhcp服务","children":[]},{"level":3,"title":"3. 配置防火墙规则","slug":"_3-配置防火墙规则","link":"#_3-配置防火墙规则","children":[]},{"level":3,"title":"4. 应用并测试防火墙规则","slug":"_4-应用并测试防火墙规则","link":"#_4-应用并测试防火墙规则","children":[]}]}],"git":{"updatedTime":1712251162000,"contributors":[{"name":"yushen","email":"85443289+yushenw@users.noreply.github.com","commits":1}]},"autoDesc":true,"filePathRelative":"posts/net/创建网络接口并使用防火墙隔离.md","excerpt":"<p>网络接口通常通过配置文件（如 <code>/etc/config/network</code>）进行定义和管理。当您创建一个新的网络（例如，一个专门为访客设计的无线网络）时，您会指定一个接口名称。这个名称随后用于系统的其他配置部分，包括防火墙规则、DHCP配置等。</p>\\n<h3>如何创建访客网络接口</h3>\\n<ol>\\n<li>\\n<p><strong>在OpenWrt中添加网络接口</strong>：您可以通过Web界面（LuCI）或直接编辑配置文件来添加新的网络接口。例如，为访客网络添加一个新的无线网络SSID，并将其关联到一个新的网络接口（例如，<code>br-guest</code>）。</p>\\n</li>\\n<li>\\n<p><strong>配置文件示例</strong>：</p>\\n<ul>\\n<li>\\n<p>编辑 <code>/etc/config/network</code> 文件，添加如下配置以创建新的桥接接口（如果适用）：</p>\\n<div class=\\"language-text\\" data-ext=\\"text\\" data-title=\\"text\\"><pre class=\\"language-text\\"><code>config interface 'guest'\\n    option type 'bridge'\\n    option ifname 'eth0.3'\\n    option proto 'static'\\n    option ipaddr '192.168.3.1'\\n    option netmask '255.255.255.0'\\n</code></pre></div></li>\\n<li>\\n<p>这里，<code>interface 'guest'</code> 定义了一个新的网络接口名为 <code>guest</code>，您可以将其理解为 <code>br-guest</code>（如果您希望使用这个特定的名称，只需相应地修改配置即可）。</p>\\n</li>\\n</ul>\\n</li>\\n<li>\\n<p><strong>更新防火墙配置</strong>：之后，您需要根据新创建的接口名（如 <code>guest</code> 或您选择的任何名称）更新防火墙配置，确保访客网络的隔离。</p>\\n</li>\\n</ol>"}`);export{d as comp,m as data};
