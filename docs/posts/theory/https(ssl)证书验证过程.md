---
title: https(ssl)证书验证过程
toc: true
keywords: 'https,tls/ssl,数字签名，数字证书'
tags:
  - https
  - tls/ssl
categories:
  - web安全
date: 2024-02-21 13:01:01
---

HTTPS证书验证是确保网络通信安全的关键步骤，主要涉及以下几个阶段：

### 1. 证书获取
当用户通过浏览器访问一个HTTPS网站时，浏览器首先会向服务器请求其SSL/TLS证书。

### 2. 证书检查
浏览器收到证书后进行以下检查：

#### a. 证书的有效期
浏览器检查证书的有效期，确保证书当前是有效的，没有过期。

#### b. 证书颁发机构（CA）
浏览器检查证书是否由一个受信任的证书颁发机构（CA）签发。浏览器和操作系统内置了受信任的CA列表。

#### c. 域名匹配
浏览器检查证书中的主题备用名称（SAN）或者通用名称（CN）是否与请求的域名匹配。这确保了证书是为当前正在访问的网站颁发的。

#### d. 证书撤销列表（CRL）和在线证书状态协议（OCSP）
浏览器可能会检查证书是否被撤销。这可以通过查询证书撤销列表（CRL）或使用在线证书状态协议（OCSP）来完成。

### 3. 证书链验证
SSL/TLS证书可能由一个证书链组成，其中包括多个证书，从网站的证书（叶节点）到根CA证书。浏览器需要验证整个证书链，确保每个证书都由上一级证书签发。最顶层的根证书需要是浏览器内置信任的根证书。

### 4. 数字签名验证
一旦证书链验证通过，浏览器将验证证书的数字签名。这是通过使用证书链中上一级证书的公钥来完成的。通过验证数字签名，浏览器可以确保证书是由CA签发的，并且自签发以来没有被篡改。

- 使用CA的公钥解密证书中的签名，得到一个哈希值。
- 浏览器对证书中除签名外的所有内容进行同样的哈希运算。
- 比较这两个哈希值，如果它们相同，证书就是合法的。

<!-- more -->

### 5. 加密通信
一旦证书验证成功，浏览器和服务器就会使用证书中的公钥来协商一个对称加密密钥。之后的通信将使用这个密钥加密，保证数据传输的安全性。

如果在任何验证步骤中失败，浏览器将警告用户，表明存在安全风险。这可能是因为证书过期、证书不受信任、证书和域名不匹配，或者证书被撤销等原因。